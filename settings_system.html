<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.4">
    <meta name="project" content="Bonfire v1.0.1-social-alpha.28">


    <title>Bonfire Settings System Documentation — Bonfire v1.0.1-social-alpha.28</title>

    <link rel="stylesheet" href="dist/html-elixir-RLZO5U2C.css" />

    <script defer src="dist/sidebar_items-9648CFAE.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-Y223O6DN.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://bonfirenetworks.org" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Bonfire" />
        </a>

      <div>
        <a href="https://bonfirenetworks.org" class="sidebar-projectName" translate="no">
Bonfire
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.0.1-social-alpha.28
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Bonfire</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Bonfire Settings System Documentation</h1>


      <a href="https://github.com/bonfire-networks/bonfire-app/blob/main/docs/topics/SETTINGS_SYSTEM.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This guide explains how to create, read, and update settings in Bonfire, covering the complete workflow from database storage to UI presentation.</p><h2 id="table-of-contents" class="section-heading"><a href="#table-of-contents" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Table of Contents</span></h2><ol><li><a href="#architecture-overview">Architecture Overview</a></li><li><a href="#settings-hierarchy">Settings Hierarchy</a></li><li><a href="#core-settings-api">Core Settings API</a></li><li><a href="#creating-settings-components">Creating Settings Components</a></li><li><a href="#settings-ui-integration">Settings UI Integration</a></li><li><a href="#practical-examples">Practical Examples</a></li><li><a href="#best-practices">Best Practices</a></li><li><a href="#troubleshooting">Troubleshooting</a></li></ol><h2 id="architecture-overview" class="section-heading"><a href="#architecture-overview" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Architecture Overview</span></h2><p>Bonfire's settings system is built around a hierarchical scope system that allows for flexible configuration at multiple levels. The system follows these core principles:</p><h3 id="key-components" class="section-heading"><a href="#key-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Key Components</span></h3><ul><li><strong><a href="./Bonfire.Common.Settings.html"><code class="inline">Bonfire.Common.Settings</code></a></strong> - Core settings API for get/put/set operations</li><li><strong><a href="./Bonfire.Data.Identity.Settings.html"><code class="inline">Bonfire.Data.Identity.Settings</code></a></strong> - Database schema for storing settings as JSON</li><li><strong>Settings Components</strong> - UI components for settings forms and inputs</li><li><strong>LiveHandler</strong> - Handles form submissions and real-time updates</li><li><strong>Scope System</strong> - Manages user/account/instance level settings</li></ul><h3 id="data-flow" class="section-heading"><a href="#data-flow" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Data Flow</span></h3><pre><code class="makeup elixir" translate="no"><span class="nc">User</span><span class="w"> </span><span class="nc">Input</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Form</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">LiveHandler</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">set</span><span class="p" data-group-id="3910959328-1">(</span><span class="p" data-group-id="3910959328-1">)</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Database</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Cache</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">UI</span><span class="w"> </span><span class="nc">Update</span></code></pre><h2 id="settings-hierarchy" class="section-heading"><a href="#settings-hierarchy" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Settings Hierarchy</span></h2><p>Settings follow a bottom-up hierarchy where more specific settings override general ones:</p><ol><li><strong>User Settings</strong> (highest priority) - Individual user preferences</li><li><strong>Account Settings</strong> - Shared account/team preferences  </li><li><strong>Instance Settings</strong> - System-wide defaults set by admins</li><li><strong>OTP Config</strong> - Compile-time and runtime application configuration</li><li><strong>Default Values</strong> (lowest priority) - Hardcoded fallbacks</li></ol><h3 id="scope-examples" class="section-heading"><a href="#scope-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Scope Examples</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># User-level setting</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="6773153961-1">(</span><span class="p" data-group-id="6773153961-2">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="6773153961-2">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;light&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="6773153961-1">)</span><span class="w">

</span><span class="c1"># Account-level setting  </span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="6773153961-3">(</span><span class="p" data-group-id="6773153961-4">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="6773153961-4">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;light&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">current_account</span><span class="p">:</span><span class="w"> </span><span class="n">account</span><span class="p" data-group-id="6773153961-3">)</span><span class="w">

</span><span class="c1"># Instance-level setting</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="6773153961-5">(</span><span class="p" data-group-id="6773153961-6">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="6773153961-6">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;light&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:instance</span><span class="p" data-group-id="6773153961-5">)</span></code></pre><h2 id="core-settings-api" class="section-heading"><a href="#core-settings-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Core Settings API</span></h2><h3 id="reading-settings" class="section-heading"><a href="#reading-settings" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Reading Settings</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># Basic usage</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="1939048378-1">(</span><span class="ss">:my_key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;default_value&quot;</span><span class="p" data-group-id="1939048378-1">)</span><span class="w">

</span><span class="c1"># With nested keys</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="1939048378-2">(</span><span class="p" data-group-id="1939048378-3">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p">,</span><span class="w"> </span><span class="ss">:dark_mode</span><span class="p" data-group-id="1939048378-3">]</span><span class="p">,</span><span class="w"> </span><span class="no">false</span><span class="p" data-group-id="1939048378-2">)</span><span class="w">

</span><span class="c1"># With user context</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="1939048378-4">(</span><span class="p" data-group-id="1939048378-5">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="1939048378-5">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;light&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="1939048378-4">)</span><span class="w">

</span><span class="c1"># With specific scope</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="1939048378-6">(</span><span class="p" data-group-id="1939048378-7">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="1939048378-7">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;light&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:instance</span><span class="p" data-group-id="1939048378-6">)</span><span class="w">

</span><span class="c1"># Required setting (raises if not found)</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="1939048378-8">(</span><span class="p" data-group-id="1939048378-9">[</span><span class="ss">:required</span><span class="p">,</span><span class="w"> </span><span class="ss">:setting</span><span class="p" data-group-id="1939048378-9">]</span><span class="p" data-group-id="1939048378-8">)</span></code></pre><h3 id="writing-settings" class="section-heading"><a href="#writing-settings" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Writing Settings</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># Set single value</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="8204546013-1">(</span><span class="ss">:my_key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_value&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="8204546013-1">)</span><span class="w">

</span><span class="c1"># Set nested value</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="8204546013-2">(</span><span class="p" data-group-id="8204546013-3">[</span><span class="ss">:ui</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p">,</span><span class="w"> </span><span class="ss">:dark_mode</span><span class="p" data-group-id="8204546013-3">]</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="8204546013-2">)</span><span class="w">

</span><span class="c1"># Set multiple values at once</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">set</span><span class="p" data-group-id="8204546013-4">(</span><span class="p" data-group-id="8204546013-5">%{</span><span class="w">
  </span><span class="ss">ui</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8204546013-6">%{</span><span class="w">
    </span><span class="ss">theme</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dark&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">font_size</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="w">
  </span><span class="p" data-group-id="8204546013-6">}</span><span class="w">
</span><span class="p" data-group-id="8204546013-5">}</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="8204546013-4">)</span><span class="w">

</span><span class="c1"># Instance-level setting (requires admin)</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="8204546013-7">(</span><span class="ss">:system_setting</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;value&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:instance</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">admin</span><span class="p" data-group-id="8204546013-7">)</span></code></pre><h3 id="scope-control" class="section-heading"><a href="#scope-control" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Scope Control</span></h3><p>The <code class="inline">scope</code> parameter determines where settings are stored:</p><ul><li><code class="inline">:user</code> - Current user's personal settings</li><li><code class="inline">:account</code> - Account/team shared settings  </li><li><code class="inline">:instance</code> - System-wide settings (admin only)</li><li><code class="inline">%User{}</code> - Specific user object</li><li><code class="inline">%Account{}</code> - Specific account object</li></ul><h2 id="creating-settings-components" class="section-heading"><a href="#creating-settings-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Creating Settings Components</span></h2><p>There are two main approaches to creating settings components:</p><h3 id="approach-1-custom-settings-components" class="section-heading"><a href="#approach-1-custom-settings-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Approach 1: Custom Settings Components</span></h3><p>For complex settings that need custom UI logic:</p><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.CustomSettingLive</span><span class="w"> </span><span class="k" data-group-id="1113986910-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings_component</span><span class="p" data-group-id="1113986910-2">(</span><span class="n">l</span><span class="p" data-group-id="1113986910-3">(</span><span class="s">&quot;My Custom Setting&quot;</span><span class="p" data-group-id="1113986910-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">icon</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fluent:settings-16-filled&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="1113986910-4">(</span><span class="s">&quot;Description of what this setting does&quot;</span><span class="p" data-group-id="1113986910-4">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">  </span><span class="c1"># or :account, :instance</span><span class="w">
  </span><span class="p" data-group-id="1113986910-2">)</span><span class="w">
</span><span class="k" data-group-id="1113986910-1">end</span></code></pre><h3 id="approach-2-template-components" class="section-heading"><a href="#approach-2-template-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Approach 2: Template Components</span></h3><p>For simple settings using built-in UI templates:</p><h4>Toggle Setting</h4><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.EnableFeatureLive</span><span class="w"> </span><span class="k" data-group-id="7173863687-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="7173863687-2">(</span><span class="ss">:toggle</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="7173863687-3">(</span><span class="s">&quot;Enable Feature&quot;</span><span class="p" data-group-id="7173863687-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7173863687-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:enable_feature</span><span class="p" data-group-id="7173863687-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="7173863687-5">(</span><span class="s">&quot;Enable this awesome feature&quot;</span><span class="p" data-group-id="7173863687-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="7173863687-2">)</span><span class="w">
</span><span class="k" data-group-id="7173863687-1">end</span></code></pre><h4>Select Setting</h4><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.ThemeSelectLive</span><span class="w"> </span><span class="k" data-group-id="5576790609-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="5576790609-2">(</span><span class="ss">:select</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5576790609-3">(</span><span class="s">&quot;Choose Theme&quot;</span><span class="p" data-group-id="5576790609-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5576790609-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p" data-group-id="5576790609-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">options</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="5576790609-5">[</span><span class="w">
      </span><span class="ss">light</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5576790609-6">(</span><span class="s">&quot;Light Theme&quot;</span><span class="p" data-group-id="5576790609-6">)</span><span class="p">,</span><span class="w">
      </span><span class="ss">dark</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5576790609-7">(</span><span class="s">&quot;Dark Theme&quot;</span><span class="p" data-group-id="5576790609-7">)</span><span class="p">,</span><span class="w">
      </span><span class="ss">auto</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5576790609-8">(</span><span class="s">&quot;Auto (System)&quot;</span><span class="p" data-group-id="5576790609-8">)</span><span class="w">
    </span><span class="p" data-group-id="5576790609-5">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="ss">:auto</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5576790609-9">(</span><span class="s">&quot;Select your preferred theme&quot;</span><span class="p" data-group-id="5576790609-9">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="5576790609-2">)</span><span class="w">
</span><span class="k" data-group-id="5576790609-1">end</span></code></pre><h4>Input Setting</h4><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.ApiKeyLive</span><span class="w"> </span><span class="k" data-group-id="8959135363-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="8959135363-2">(</span><span class="ss">:input</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="8959135363-3">(</span><span class="s">&quot;API Key&quot;</span><span class="p" data-group-id="8959135363-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8959135363-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:api_key</span><span class="p" data-group-id="8959135363-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="8959135363-5">(</span><span class="s">&quot;Enter your API key for external service&quot;</span><span class="p" data-group-id="8959135363-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="8959135363-2">)</span><span class="w">
</span><span class="k" data-group-id="8959135363-1">end</span></code></pre><h4>Number Setting</h4><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.ItemLimitLive</span><span class="w"> </span><span class="k" data-group-id="2518679139-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="2518679139-2">(</span><span class="ss">:number</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2518679139-3">(</span><span class="s">&quot;Items per page&quot;</span><span class="p" data-group-id="2518679139-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2518679139-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:items_per_page</span><span class="p" data-group-id="2518679139-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="ss">unit</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2518679139-5">(</span><span class="s">&quot;items&quot;</span><span class="p" data-group-id="2518679139-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2518679139-6">(</span><span class="s">&quot;How many items to show per page&quot;</span><span class="p" data-group-id="2518679139-6">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="2518679139-2">)</span><span class="w">
</span><span class="k" data-group-id="2518679139-1">end</span></code></pre><h3 id="available-form-template-components-types" class="section-heading"><a href="#available-form-template-components-types" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Available Form Template Components Types</span></h3><ul><li><code class="inline">:toggle</code> - Simple on/off checkbox</li><li><code class="inline">:toggles</code> - Multiple checkboxes</li><li><code class="inline">:radios</code> - Radio button group</li><li><code class="inline">:select</code> - Dropdown selection</li><li><code class="inline">:input</code> - Text input field</li><li><code class="inline">:textarea</code> - Multi-line text area</li><li><code class="inline">:number</code> - Number input with unit label</li></ul><h2 id="settings-ui-integration" class="section-heading"><a href="#settings-ui-integration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Settings UI Integration</span></h2><h3 id="manual-form-integration" class="section-heading"><a href="#manual-form-integration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Manual Form Integration</span></h3><p>For custom forms, use the standardized form components when possible:</p><pre><code class="makeup html" translate="no"><span class="p" data-group-id="4154178054-1">&lt;</span><span class="nt">form</span><span class="w"> </span><span class="na">data-scope</span><span class="o">=</span><span class="s">&quot;my_setting_scope&quot;</span><span class="w"> </span><span class="na">name</span><span class="o">=</span><span class="s">&quot;settings&quot;</span><span class="w"> </span><span class="na">phx-change</span><span class="o">=</span><span class="s">&quot;Bonfire.Common.Settings:set&quot;</span><span class="p" data-group-id="4154178054-1">&gt;</span><span class="s">
  </span><span class="p" data-group-id="4154178054-2">&lt;</span><span class="nt">input</span><span class="w"> </span><span class="na">name</span><span class="o">=</span><span class="s">&quot;scope&quot;</span><span class="w"> </span><span class="na">value</span><span class="o">=</span><span class="s">{@scope}</span><span class="w"> </span><span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span><span class="p" data-group-id="4154178054-2">&gt;</span><span class="s">
  
  </span><span class="p" data-group-id="4154178054-3">&lt;</span><span class="nt">Bonfire.UI.Common.SettingsToggleLive</span><span class="w">
    </span><span class="na">name</span><span class="o">=</span><span class="s">{l(&quot;Enable</span><span class="w"> </span><span class="s">Feature&quot;)}</span><span class="w">
    </span><span class="na">description</span><span class="o">=</span><span class="s">{l(&quot;This</span><span class="w"> </span><span class="na">enables</span><span class="w"> </span><span class="na">the</span><span class="w"> </span><span class="na">awesome</span><span class="w"> </span><span class="s">feature&quot;)}</span><span class="w">
    </span><span class="na">keys</span><span class="o">=</span><span class="s">{[MyExtension,</span><span class="w"> </span><span class="s">:enable_feature]}</span><span class="w">
    </span><span class="na">scope</span><span class="o">=</span><span class="s">{@scope}</span><span class="w">
  </span><span class="p" data-group-id="4154178054-3">/&gt;</span><span class="w">
</span><span class="p" data-group-id="4154178054-4">&lt;/</span><span class="nt">form</span><span class="p" data-group-id="4154178054-4">&gt;</span></code></pre><h3 id="livehandler-integration" class="section-heading"><a href="#livehandler-integration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">LiveHandler Integration</span></h3><p>The <a href="./Bonfire.Common.Settings.LiveHandler.html"><code class="inline">Bonfire.Common.Settings.LiveHandler</code></a> provides these events:</p><ul><li><code class="inline">&quot;set&quot;</code> - Set multiple settings from form data</li><li><code class="inline">&quot;put&quot;</code> - Set single setting by key path</li><li><code class="inline">&quot;save&quot;</code> - Save settings with success message</li></ul><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p" data-group-id="6683533452-1">(</span><span class="s">&quot;set&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="6683533452-1">)</span><span class="w"> </span><span class="k" data-group-id="6683533452-2">do</span><span class="w">
  </span><span class="c1"># Automatically handled by LiveHandler</span><span class="w">
  </span><span class="c1"># Shows flash message on success</span><span class="w">
</span><span class="k" data-group-id="6683533452-2">end</span></code></pre><h2 id="practical-examples" class="section-heading"><a href="#practical-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Practical Examples</span></h2><h3 id="example-1-simple-toggle-setting" class="section-heading"><a href="#example-1-simple-toggle-setting" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example 1: Simple Toggle Setting</span></h3><p>Create a setting to enable/disable a feature:</p><ol><li><strong>Create the settings component:</strong></li></ol><pre><code class="makeup elixir" translate="no"><span class="c1"># extensions/my_extension/lib/components/settings/enable_notifications_live.ex</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.EnableNotificationsLive</span><span class="w"> </span><span class="k" data-group-id="7344008023-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="7344008023-2">(</span><span class="ss">:toggle</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="7344008023-3">(</span><span class="s">&quot;Enable Email Notifications&quot;</span><span class="p" data-group-id="7344008023-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7344008023-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:enable_notifications</span><span class="p" data-group-id="7344008023-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="7344008023-5">(</span><span class="s">&quot;Receive email notifications for new messages&quot;</span><span class="p" data-group-id="7344008023-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="7344008023-2">)</span><span class="w">
</span><span class="k" data-group-id="7344008023-1">end</span></code></pre><ol start="2"><li><strong>Use the setting in your code:</strong></li></ol><pre><code class="makeup elixir" translate="no"><span class="c1"># Check if notifications are enabled</span><span class="w">
</span><span class="k">if</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="1169872780-1">(</span><span class="p" data-group-id="1169872780-2">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:enable_notifications</span><span class="p" data-group-id="1169872780-2">]</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="1169872780-1">)</span><span class="w"> </span><span class="k" data-group-id="1169872780-3">do</span><span class="w">
  </span><span class="c1"># Send notification</span><span class="w">
  </span><span class="n">send_email_notification</span><span class="p" data-group-id="1169872780-4">(</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p" data-group-id="1169872780-4">)</span><span class="w">
</span><span class="k" data-group-id="1169872780-3">end</span></code></pre><h3 id="example-2-select-setting-with-multiple-options" class="section-heading"><a href="#example-2-select-setting-with-multiple-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example 2: Select Setting with Multiple Options</span></h3><p>Create a setting for choosing notification frequency:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># extensions/my_extension/lib/components/settings/notification_frequency_live.ex</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.NotificationFrequencyLive</span><span class="w"> </span><span class="k" data-group-id="6727784745-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="6727784745-2">(</span><span class="ss">:select</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-3">(</span><span class="s">&quot;Notification Frequency&quot;</span><span class="p" data-group-id="6727784745-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6727784745-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:notification_frequency</span><span class="p" data-group-id="6727784745-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">options</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="6727784745-5">[</span><span class="w">
      </span><span class="ss">immediate</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-6">(</span><span class="s">&quot;Immediate&quot;</span><span class="p" data-group-id="6727784745-6">)</span><span class="p">,</span><span class="w">
      </span><span class="ss">hourly</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-7">(</span><span class="s">&quot;Hourly Digest&quot;</span><span class="p" data-group-id="6727784745-7">)</span><span class="p">,</span><span class="w">
      </span><span class="ss">daily</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-8">(</span><span class="s">&quot;Daily Digest&quot;</span><span class="p" data-group-id="6727784745-8">)</span><span class="p">,</span><span class="w">
      </span><span class="ss">never</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-9">(</span><span class="s">&quot;Never&quot;</span><span class="p" data-group-id="6727784745-9">)</span><span class="w">
    </span><span class="p" data-group-id="6727784745-5">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="ss">:daily</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="6727784745-10">(</span><span class="s">&quot;How often to receive notification emails&quot;</span><span class="p" data-group-id="6727784745-10">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="6727784745-2">)</span><span class="w">
</span><span class="k" data-group-id="6727784745-1">end</span></code></pre><h3 id="example-3-custom-settings-component" class="section-heading"><a href="#example-3-custom-settings-component" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example 3: Custom Settings Component</span></h3><p>For complex settings that need custom logic:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># extensions/my_extension/lib/components/settings/advanced_config_live.ex</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.AdvancedConfigLive</span><span class="w"> </span><span class="k" data-group-id="8744841759-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings_component</span><span class="p" data-group-id="8744841759-2">(</span><span class="n">l</span><span class="p" data-group-id="8744841759-3">(</span><span class="s">&quot;Advanced Configuration&quot;</span><span class="p" data-group-id="8744841759-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">icon</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fluent:settings-16-filled&quot;</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="8744841759-4">(</span><span class="s">&quot;Advanced settings for power users&quot;</span><span class="p" data-group-id="8744841759-4">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:user</span><span class="w">
  </span><span class="p" data-group-id="8744841759-2">)</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">render</span><span class="p" data-group-id="8744841759-5">(</span><span class="n">assigns</span><span class="p" data-group-id="8744841759-5">)</span><span class="w"> </span><span class="k" data-group-id="8744841759-6">do</span><span class="w">
    </span><span class="sx">~F&quot;&quot;&quot;
    &lt;div class=&quot;space-y-4&quot;&gt;
      &lt;form data-scope=&quot;advanced_config&quot; name=&quot;settings&quot; phx-change=&quot;Bonfire.Common.Settings:set&quot;&gt;
        &lt;input name=&quot;scope&quot; value={@scope} type=&quot;hidden&quot;&gt;
        
        &lt;div class=&quot;form-control&quot;&gt;
          &lt;label class=&quot;label&quot;&gt;
            &lt;span class=&quot;label-text&quot;&gt;{l(&quot;Custom API Endpoint&quot;)}&lt;/span&gt;
          &lt;/label&gt;
          &lt;input 
            type=&quot;url&quot; 
            name={input_name([MyExtension, :api_endpoint])}
            value={Settings.get([MyExtension, :api_endpoint], &quot;&quot;, context: @__context__)}
            class=&quot;input input-bordered&quot;
            placeholder=&quot;https://api.example.com&quot;
          /&gt;
        &lt;/div&gt;

        &lt;div class=&quot;form-control&quot;&gt;
          &lt;label class=&quot;label&quot;&gt;
            &lt;span class=&quot;label-text&quot;&gt;{l(&quot;Timeout (seconds)&quot;)}&lt;/span&gt;
          &lt;/label&gt;
          &lt;input 
            type=&quot;number&quot; 
            name={input_name([MyExtension, :timeout])}
            value={Settings.get([MyExtension, :timeout], 30, context: @__context__)}
            class=&quot;input input-bordered&quot;
            min=&quot;1&quot;
            max=&quot;300&quot;
          /&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
    &quot;&quot;&quot;</span><span class="w">
  </span><span class="k" data-group-id="8744841759-6">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">input_name</span><span class="p" data-group-id="8744841759-7">(</span><span class="n">keys</span><span class="p" data-group-id="8744841759-7">)</span><span class="w"> </span><span class="k" data-group-id="8744841759-8">do</span><span class="w">
    </span><span class="nc">Bonfire.Common.Settings.LiveHandler</span><span class="o">.</span><span class="n">input_name</span><span class="p" data-group-id="8744841759-9">(</span><span class="n">keys</span><span class="p" data-group-id="8744841759-9">)</span><span class="w">
  </span><span class="k" data-group-id="8744841759-8">end</span><span class="w">
</span><span class="k" data-group-id="8744841759-1">end</span></code></pre><h3 id="example-4-instance-level-setting" class="section-heading"><a href="#example-4-instance-level-setting" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example 4: Instance-Level Setting</span></h3><p>Create an admin-only instance setting:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># extensions/my_extension/lib/components/settings/instance_limits_live.ex</span><span class="w">
</span><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.Settings.InstanceLimitsLive</span><span class="w"> </span><span class="k" data-group-id="2700908217-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.UI.Common.Web</span><span class="p">,</span><span class="w"> </span><span class="ss">:stateless_component</span><span class="w">

  </span><span class="n">prop</span><span class="w"> </span><span class="n">scope</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">

  </span><span class="n">declare_settings</span><span class="p" data-group-id="2700908217-2">(</span><span class="ss">:number</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2700908217-3">(</span><span class="s">&quot;Maximum Items Per User&quot;</span><span class="p" data-group-id="2700908217-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">keys</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2700908217-4">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:max_items_per_user</span><span class="p" data-group-id="2700908217-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">default_value</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="ss">unit</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2700908217-5">(</span><span class="s">&quot;items&quot;</span><span class="p" data-group-id="2700908217-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">description</span><span class="p">:</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="2700908217-6">(</span><span class="s">&quot;Maximum number of items each user can create&quot;</span><span class="p" data-group-id="2700908217-6">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:instance</span><span class="w">  </span><span class="c1"># Admin only</span><span class="w">
  </span><span class="p" data-group-id="2700908217-2">)</span><span class="w">
</span><span class="k" data-group-id="2700908217-1">end</span></code></pre><h2 id="best-practices" class="section-heading"><a href="#best-practices" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Best Practices</span></h2><h3 id="naming-conventions" class="section-heading"><a href="#naming-conventions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Naming Conventions</span></h3><ol><li><p><strong>Keys should be hierarchical:</strong></p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="9176138599-1">[</span><span class="ss">:my_extension</span><span class="p">,</span><span class="w"> </span><span class="ss">:feature</span><span class="p">,</span><span class="w"> </span><span class="ss">:sub_feature</span><span class="p" data-group-id="9176138599-1">]</span><span class="w">  </span><span class="c1"># Good</span><span class="w">
</span><span class="p" data-group-id="9176138599-2">[</span><span class="ss">:my_random_key</span><span class="p" data-group-id="9176138599-2">]</span><span class="w">                       </span><span class="c1"># Avoid</span></code></pre></li><li><p><strong>Use your module or extension as the top-level key:</strong></p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="6480248495-1">[</span><span class="nc">Bonfire.UI.Social.Feed</span><span class="p">,</span><span class="w"> </span><span class="ss">:default_sort</span><span class="p" data-group-id="6480248495-1">]</span><span class="w">  </span><span class="c1"># Good</span><span class="w">
</span><span class="p" data-group-id="6480248495-2">[</span><span class="ss">:feed</span><span class="p">,</span><span class="w"> </span><span class="ss">:default_sort</span><span class="p" data-group-id="6480248495-2">]</span><span class="w">                      </span><span class="c1"># Avoid - conflicts possible</span></code></pre></li></ol><h3 id="default-values" class="section-heading"><a href="#default-values" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Default Values</span></h3><p>Always provide sensible defaults:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># Good - provides fallback</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="9201096755-1">(</span><span class="p" data-group-id="9201096755-2">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:timeout</span><span class="p" data-group-id="9201096755-2">]</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9201096755-1">)</span><span class="w">

</span><span class="c1"># Bad - could return nil unexpectedly  </span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="9201096755-3">(</span><span class="p" data-group-id="9201096755-4">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:timeout</span><span class="p" data-group-id="9201096755-4">]</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9201096755-3">)</span></code></pre><h3 id="scoping" class="section-heading"><a href="#scoping" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Scoping</span></h3><p>Choose appropriate scopes:</p><ul><li><strong>User scope</strong> - Specific preferences for that profile (privacy settings, notifications)</li><li><strong>Account scope</strong> - General personal preferences (theme, language)</li><li><strong>Instance scope</strong> - System-wide configuration (limits, features)</li></ul><h3 id="performance" class="section-heading"><a href="#performance" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Performance</span></h3><ul><li>Instance-level settings are cached in OTP config </li><li>User and account settings are loaded from database (all loaded once per page rather than queried individually when needed)</li><li>Preload settings associations when querying user/account objects</li></ul><h3 id="security" class="section-heading"><a href="#security" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Security</span></h3><ul><li>Instance settings require admin permissions</li><li>Avoid storing secrets in settings (use environment variables)</li><li>Validate and sanitize user input</li><li>Consider privacy implications of settings data</li></ul><h3 id="testing" class="section-heading"><a href="#testing" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Testing</span></h3><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyExtension.SettingsTest</span><span class="w"> </span><span class="k" data-group-id="9113449831-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.DataCase</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Bonfire.Common.Settings</span><span class="w">

  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;setting default value&quot;</span><span class="w"> </span><span class="k" data-group-id="9113449831-2">do</span><span class="w">
    </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fake_user!</span><span class="p" data-group-id="9113449831-3">(</span><span class="p" data-group-id="9113449831-3">)</span><span class="w">
    
    </span><span class="c1"># Test default</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="9113449831-4">(</span><span class="p" data-group-id="9113449831-5">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:feature</span><span class="p" data-group-id="9113449831-5">]</span><span class="p">,</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9113449831-4">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">false</span><span class="w">
    
    </span><span class="c1"># Test setting value</span><span class="w">
    </span><span class="p" data-group-id="9113449831-6">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="9113449831-6">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="9113449831-7">(</span><span class="p" data-group-id="9113449831-8">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:feature</span><span class="p" data-group-id="9113449831-8">]</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9113449831-7">)</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="9113449831-9">(</span><span class="p" data-group-id="9113449831-10">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:feature</span><span class="p" data-group-id="9113449831-10">]</span><span class="p">,</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9113449831-9">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="no">true</span><span class="w">
  </span><span class="k" data-group-id="9113449831-2">end</span><span class="w">

  </span><span class="n">test</span><span class="w"> </span><span class="s">&quot;hierarchy works correctly&quot;</span><span class="w"> </span><span class="k" data-group-id="9113449831-11">do</span><span class="w">
    </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fake_user!</span><span class="p" data-group-id="9113449831-12">(</span><span class="p" data-group-id="9113449831-12">)</span><span class="w">
    
    </span><span class="c1"># Instance setting</span><span class="w">
    </span><span class="p" data-group-id="9113449831-13">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="9113449831-13">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="9113449831-14">(</span><span class="p" data-group-id="9113449831-15">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:limit</span><span class="p" data-group-id="9113449831-15">]</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="ss">scope</span><span class="p">:</span><span class="w"> </span><span class="ss">:instance</span><span class="p">,</span><span class="w"> </span><span class="ss">skip_boundary_check</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="9113449831-14">)</span><span class="w">
    
    </span><span class="c1"># User override</span><span class="w">
    </span><span class="p" data-group-id="9113449831-16">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="9113449831-16">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="9113449831-17">(</span><span class="p" data-group-id="9113449831-18">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:limit</span><span class="p" data-group-id="9113449831-18">]</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9113449831-17">)</span><span class="w">
    
    </span><span class="c1"># User setting takes precedence</span><span class="w">
    </span><span class="n">assert</span><span class="w"> </span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="9113449831-19">(</span><span class="p" data-group-id="9113449831-20">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:limit</span><span class="p" data-group-id="9113449831-20">]</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p" data-group-id="9113449831-19">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">50</span><span class="w">
  </span><span class="k" data-group-id="9113449831-11">end</span><span class="w">
</span><span class="k" data-group-id="9113449831-1">end</span></code></pre><h2 id="troubleshooting" class="section-heading"><a href="#troubleshooting" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Troubleshooting</span></h2><h3 id="common-issues" class="section-heading"><a href="#common-issues" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Common Issues</span></h3><ol><li><p><strong>Settings not saving:</strong></p><ul><li>Check that form has <code class="inline">phx-change=&quot;Bonfire.Common.Settings:set&quot;</code></li><li>Ensure <code class="inline">scope</code> input is included in form</li><li>Verify user has permission for the scope</li></ul></li><li><p><strong>Settings not loading:</strong></p><ul><li>Confirm keys match exactly (atoms vs strings)</li><li>Check that default value is provided</li><li>Verify context includes current_user/current_account</li></ul></li><li><p><strong>Permission errors:</strong></p><ul><li>Instance settings require admin permissions</li><li>Check <code class="inline">skip_boundary_check: true</code> for testing</li><li>Verify user is properly authenticated</li></ul></li><li><p><strong>Settings not appearing in UI:</strong></p><ul><li>Check file is in correct extension directory</li><li>Verify component uses <code class="inline">declare_settings_component</code> or <code class="inline">declare_settings</code></li><li>Ensure extension is enabled</li></ul></li></ol><h3 id="debugging" class="section-heading"><a href="#debugging" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Debugging</span></h3><p>Enable debug logging:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># In your settings call</span><span class="w">
</span><span class="nc">Settings</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="7973887011-1">(</span><span class="p" data-group-id="7973887011-2">[</span><span class="nc">MyExt</span><span class="p">,</span><span class="w"> </span><span class="ss">:setting</span><span class="p" data-group-id="7973887011-2">]</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> 
  </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w">
  </span><span class="ss">debug</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="w">  </span><span class="c1"># Shows lookup process</span><span class="w">
</span><span class="p" data-group-id="7973887011-1">)</span></code></pre><p>Check database directly:</p><pre><code class="makeup sql" translate="no"><span class="kr">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">FROM</span><span class="w"> </span><span class="n">bonfire_data_identity_settings</span><span class="w"> 
</span><span class="kr">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;user_id_here&#39;</span><span class="p">;</span></code></pre><h3 id="key-validation" class="section-heading"><a href="#key-validation" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Key Validation</span></h3><p>Settings keys should follow these patterns:</p><pre><code class="makeup elixir" translate="no"><span class="c1"># Good patterns</span><span class="w">
</span><span class="p" data-group-id="3536493024-1">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:feature_name</span><span class="p" data-group-id="3536493024-1">]</span><span class="w">
</span><span class="p" data-group-id="3536493024-2">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="ss">:category</span><span class="p">,</span><span class="w"> </span><span class="ss">:setting</span><span class="p" data-group-id="3536493024-2">]</span><span class="w">
</span><span class="p" data-group-id="3536493024-3">[</span><span class="nc">Bonfire.UI.Common</span><span class="p">,</span><span class="w"> </span><span class="ss">:theme</span><span class="p">,</span><span class="w"> </span><span class="ss">:dark_mode</span><span class="p" data-group-id="3536493024-3">]</span><span class="w">

</span><span class="c1"># Bad patterns - avoid</span><span class="w">
</span><span class="p" data-group-id="3536493024-4">[</span><span class="ss">:global_setting</span><span class="p" data-group-id="3536493024-4">]</span><span class="w">              </span><span class="c1"># Too generic</span><span class="w">
</span><span class="p" data-group-id="3536493024-5">[</span><span class="s">&quot;string_key&quot;</span><span class="p" data-group-id="3536493024-5">]</span><span class="w">                 </span><span class="c1"># Use atoms where sensible</span><span class="w">
</span><span class="p" data-group-id="3536493024-6">[</span><span class="nc">MyExtension</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mixed&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">:types</span><span class="p" data-group-id="3536493024-6">]</span><span class="w"> </span><span class="c1"># Be consistent</span></code></pre><h2 id="conclusion" class="section-heading"><a href="#conclusion" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Conclusion</span></h2><p>The Bonfire settings system provides a flexible, hierarchical way to manage configuration at multiple levels. By following the patterns and best practices outlined in this guide, you can create robust, user-friendly settings for your extensions.</p><p>Key takeaways:</p><ul><li>Use the hierarchical scope system (user &gt; account &gt; instance &gt; OTP config &gt; code)</li><li>Choose between custom components and template components based on complexity</li><li>Always provide default values and consider performance</li><li>Test your settings thoroughly and follow security best practices</li><li>Leverage the automatic UI integration for consistent user experience</li></ul><p>For more examples, examine existing settings components in the <code class="inline">bonfire_ui_*</code> extensions.</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="pubsub_guide.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Bonfire PubSub System Guide
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="federation-interoperability.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Bonfire Federation Interoperability Guide
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="Bonfire.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.4) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
