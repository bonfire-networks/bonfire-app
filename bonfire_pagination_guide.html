<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.4">
    <meta name="project" content="Bonfire v1.0.0-social-rc.2.24">


    <title>Bonfire Pagination Implementation Guide — Bonfire v1.0.0-social-rc.2.24</title>

    <link rel="stylesheet" href="dist/html-elixir-RLZO5U2C.css" />

    <script defer src="dist/sidebar_items-2D9D48B9.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-Y223O6DN.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="https://bonfirenetworks.org" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="Bonfire" />
        </a>

      <div>
        <a href="https://bonfirenetworks.org" class="sidebar-projectName" translate="no">
Bonfire
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.0.0-social-rc.2.24
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of Bonfire</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Bonfire Pagination Implementation Guide</h1>


      <a href="https://github.com/bonfire-networks/bonfire-app/blob/main/docs/topics/BONFIRE_PAGINATION_GUIDE.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This guide outlines the established patterns for implementing pagination in Bonfire components. Use this as a reference for consistent pagination implementations across the codebase.</p><h2 id="core-architecture" class="section-heading"><a href="#core-architecture" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Core Architecture</span></h2><h3 id="components-overview" class="section-heading"><a href="#components-overview" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Components Overview</span></h3><ul><li><strong>LoadMoreLive</strong>: Reusable pagination component (<code class="inline">bonfire_ui_common/lib/components/paginate/load_more_live.sface</code>)</li><li><strong>Live Handlers</strong>: Handle pagination events and data loading</li><li><strong>Parent LiveViews</strong>: Route events from stateless components to handlers</li><li><strong>Backend Functions</strong>: Return paginated data with <code class="inline">%{edges: [], page_info: %{}}</code></li></ul><h3 id="data-flow" class="section-heading"><a href="#data-flow" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Data Flow</span></h3><pre><code class="makeup elixir" translate="no"><span class="nc">User</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="s">&quot;Load more&quot;</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">LoadMoreLive</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Parent</span><span class="w"> </span><span class="nc">LiveView</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Live</span><span class="w"> </span><span class="nc">Handler</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Backend</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="nc">Updated</span><span class="w"> </span><span class="nc">UI</span></code></pre><h2 id="implementation-patterns" class="section-heading"><a href="#implementation-patterns" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Implementation Patterns</span></h2><h3 id="1-backend-pagination-functions" class="section-heading"><a href="#1-backend-pagination-functions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">1. Backend Pagination Functions</span></h3><p>All pagination functions should use the <code class="inline">many/3</code> helper and return standardized structure:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">list_items</span><span class="p" data-group-id="2507230216-1">(</span><span class="n">filters</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="p" data-group-id="2507230216-2">[</span><span class="p" data-group-id="2507230216-2">]</span><span class="p" data-group-id="2507230216-1">)</span><span class="w"> </span><span class="k" data-group-id="2507230216-3">do</span><span class="w">
  </span><span class="n">query</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">apply_filters</span><span class="p" data-group-id="2507230216-4">(</span><span class="n">filters</span><span class="p" data-group-id="2507230216-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">proload</span><span class="p" data-group-id="2507230216-5">(</span><span class="p" data-group-id="2507230216-6">[</span><span class="ss">:associations</span><span class="p" data-group-id="2507230216-6">]</span><span class="p" data-group-id="2507230216-5">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">many</span><span class="p" data-group-id="2507230216-7">(</span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="2507230216-7">)</span><span class="w">  </span><span class="c1"># Returns %{edges: [], page_info: %{}}</span><span class="w">
</span><span class="k" data-group-id="2507230216-3">end</span></code></pre><p><strong>Page Info Structure:</strong></p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="0119278440-1">%{</span><span class="w">
  </span><span class="ss">end_cursor</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cursor_string&quot;</span><span class="p">,</span><span class="w">
  </span><span class="ss">has_next_page</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="o">/</span><span class="no">false</span><span class="p">,</span><span class="w">
  </span><span class="ss">page_count</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="ss">final_cursor</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;final_cursor_string&quot;</span><span class="w">
</span><span class="p" data-group-id="0119278440-1">}</span></code></pre><h3 id="2-live-handler-events" class="section-heading"><a href="#2-live-handler-events" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">2. Live Handler Events</span></h3><h4>Standard load_more Handler Pattern:</h4><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p" data-group-id="3971142764-1">(</span><span class="s">&quot;load_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3971142764-2">%{</span><span class="s">&quot;context&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">context</span><span class="p" data-group-id="3971142764-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3971142764-1">)</span><span class="w"> </span><span class="k" data-group-id="3971142764-3">do</span><span class="w">
  </span><span class="n">current_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_user</span><span class="p" data-group-id="3971142764-4">(</span><span class="n">socket</span><span class="p" data-group-id="3971142764-4">)</span><span class="w">
  
  </span><span class="c1"># Validation</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">validation_fails</span><span class="p" data-group-id="3971142764-5">(</span><span class="p" data-group-id="3971142764-5">)</span><span class="w"> </span><span class="k" data-group-id="3971142764-6">do</span><span class="w">
    </span><span class="p" data-group-id="3971142764-7">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">assign_flash</span><span class="p" data-group-id="3971142764-8">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="3971142764-9">(</span><span class="s">&quot;Error message&quot;</span><span class="p" data-group-id="3971142764-9">)</span><span class="p" data-group-id="3971142764-8">)</span><span class="p" data-group-id="3971142764-7">}</span><span class="w">
  </span><span class="k" data-group-id="3971142764-6">else</span><span class="w">
    </span><span class="n">pagination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_to_atoms</span><span class="p" data-group-id="3971142764-10">(</span><span class="n">params</span><span class="p" data-group-id="3971142764-10">)</span><span class="w">
    
    </span><span class="k">try</span><span class="w"> </span><span class="k" data-group-id="3971142764-11">do</span><span class="w">
      </span><span class="c1"># Load next page of data</span><span class="w">
      </span><span class="n">new_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">YourContext</span><span class="o">.</span><span class="n">list_items</span><span class="p" data-group-id="3971142764-12">(</span><span class="w">
        </span><span class="n">filters</span><span class="p">,</span><span class="w">
        </span><span class="ss">pagination</span><span class="p">:</span><span class="w"> </span><span class="n">pagination</span><span class="p">,</span><span class="w">
        </span><span class="ss">current_user</span><span class="p">:</span><span class="w"> </span><span class="n">current_user</span><span class="w">
      </span><span class="p" data-group-id="3971142764-12">)</span><span class="w">
      
      </span><span class="p" data-group-id="3971142764-13">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w">
       </span><span class="n">socket</span><span class="w">
       </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">assign</span><span class="p" data-group-id="3971142764-14">(</span><span class="w">
         </span><span class="ss">items</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="3971142764-15">(</span><span class="n">assigns</span><span class="p" data-group-id="3971142764-16">(</span><span class="n">socket</span><span class="p" data-group-id="3971142764-16">)</span><span class="p">,</span><span class="w"> </span><span class="ss">:items</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3971142764-17">[</span><span class="p" data-group-id="3971142764-17">]</span><span class="p" data-group-id="3971142764-15">)</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="3971142764-18">(</span><span class="n">new_data</span><span class="p">,</span><span class="w"> </span><span class="ss">:edges</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3971142764-19">[</span><span class="p" data-group-id="3971142764-19">]</span><span class="p" data-group-id="3971142764-18">)</span><span class="p">,</span><span class="w">
         </span><span class="ss">page_info</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="3971142764-20">(</span><span class="n">new_data</span><span class="p">,</span><span class="w"> </span><span class="ss">:page_info</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3971142764-21">[</span><span class="p" data-group-id="3971142764-21">]</span><span class="p" data-group-id="3971142764-20">)</span><span class="p">,</span><span class="w">
         </span><span class="ss">previous_page_info</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="3971142764-22">(</span><span class="n">assigns</span><span class="p" data-group-id="3971142764-23">(</span><span class="n">socket</span><span class="p" data-group-id="3971142764-23">)</span><span class="p">,</span><span class="w"> </span><span class="ss">:page_info</span><span class="p">,</span><span class="w"> </span><span class="no">nil</span><span class="p" data-group-id="3971142764-22">)</span><span class="p">,</span><span class="w">
         </span><span class="ss">loading</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
       </span><span class="p" data-group-id="3971142764-14">)</span><span class="p" data-group-id="3971142764-13">}</span><span class="w">
    </span><span class="k" data-group-id="3971142764-11">rescue</span><span class="w">
      </span><span class="n">error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
        </span><span class="n">error</span><span class="p" data-group-id="3971142764-24">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to load more </span><span class="si" data-group-id="3971142764-25">#{</span><span class="n">context</span><span class="si" data-group-id="3971142764-25">}</span><span class="s">&quot;</span><span class="p" data-group-id="3971142764-24">)</span><span class="w">
        </span><span class="p" data-group-id="3971142764-26">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">assign_flash</span><span class="p" data-group-id="3971142764-27">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="3971142764-28">(</span><span class="s">&quot;Could not load more&quot;</span><span class="p" data-group-id="3971142764-28">)</span><span class="p" data-group-id="3971142764-27">)</span><span class="p" data-group-id="3971142764-26">}</span><span class="w">
    </span><span class="k" data-group-id="3971142764-11">end</span><span class="w">
  </span><span class="k" data-group-id="3971142764-6">end</span><span class="w">
</span><span class="k" data-group-id="3971142764-3">end</span></code></pre><h4>Optional preload_more Handler:</h4><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p" data-group-id="7757455524-1">(</span><span class="s">&quot;preload_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7757455524-2">%{</span><span class="s">&quot;context&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">context</span><span class="p" data-group-id="7757455524-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7757455524-1">)</span><span class="w"> </span><span class="k" data-group-id="7757455524-3">do</span><span class="w">
  </span><span class="c1"># Same as load_more but for infinite scroll preloading</span><span class="w">
  </span><span class="n">handle_event</span><span class="p" data-group-id="7757455524-4">(</span><span class="s">&quot;load_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7757455524-4">)</span><span class="w">
</span><span class="k" data-group-id="7757455524-3">end</span></code></pre><h3 id="3-parent-liveview-event-routing" class="section-heading"><a href="#3-parent-liveview-event-routing" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">3. Parent LiveView Event Routing</span></h3><p>For stateless components, parent LiveViews must route events:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p" data-group-id="8799065393-1">(</span><span class="s">&quot;YourModule:load_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-1">)</span><span class="w"> </span><span class="k" data-group-id="8799065393-2">do</span><span class="w">
  </span><span class="n">maybe_apply</span><span class="p" data-group-id="8799065393-3">(</span><span class="w">
    </span><span class="nc">YourModule.LiveHandler</span><span class="p">,</span><span class="w">
    </span><span class="ss">:handle_event</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8799065393-4">[</span><span class="s">&quot;load_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-4">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">fallback_return</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8799065393-5">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-5">}</span><span class="w">
  </span><span class="p" data-group-id="8799065393-3">)</span><span class="w">
</span><span class="k" data-group-id="8799065393-2">end</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p" data-group-id="8799065393-6">(</span><span class="s">&quot;YourModule:preload_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-6">)</span><span class="w"> </span><span class="k" data-group-id="8799065393-7">do</span><span class="w">
  </span><span class="n">maybe_apply</span><span class="p" data-group-id="8799065393-8">(</span><span class="w">
    </span><span class="nc">YourModule.LiveHandler</span><span class="p">,</span><span class="w">
    </span><span class="ss">:handle_event</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="8799065393-9">[</span><span class="s">&quot;preload_more&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-9">]</span><span class="p">,</span><span class="w">
    </span><span class="ss">fallback_return</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8799065393-10">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8799065393-10">}</span><span class="w">
  </span><span class="p" data-group-id="8799065393-8">)</span><span class="w">
</span><span class="k" data-group-id="8799065393-7">end</span></code></pre><h3 id="4-loadmorelive-component-usage" class="section-heading"><a href="#4-loadmorelive-component-usage" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">4. LoadMoreLive Component Usage</span></h3><h4>Basic Usage:</h4><pre><code class="surface">&lt;Bonfire.UI.Common.LoadMoreLive
  :if={@page_info}
  live_handler=&quot;YourModule&quot;
  page_info={@page_info}
  context={@current_context}
  hide_guest_fallback
  hide_if_no_more
&gt;
  &lt;:if_no_more&gt;
    &lt;p class=&quot;text-center text-base-content/70 py-4&quot;&gt;{l(&quot;That's all!&quot;)}&lt;/p&gt;
  &lt;/:if_no_more&gt;
&lt;/Bonfire.UI.Common.LoadMoreLive&gt;</code></pre><h4>Key Properties:</h4><ul><li><code class="inline">live_handler</code>: Module name that handles events</li><li><code class="inline">page_info</code>: Pagination metadata from backend</li><li><code class="inline">context</code>: Identifies which list/feed for multiple lists on same page</li><li><code class="inline">hide_if_no_more</code>: Hide component when no more data</li><li><code class="inline">infinite_scroll</code>: Enable/disable infinite scroll behavior</li></ul><h3 id="5-required-assigns-for-components" class="section-heading"><a href="#5-required-assigns-for-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">5. Required Assigns for Components</span></h3><p>Components using pagination should accept:</p><pre><code class="makeup elixir" translate="no"><span class="n">prop</span><span class="w"> </span><span class="n">items</span><span class="p">,</span><span class="w"> </span><span class="ss">:list</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="7569298402-1">[</span><span class="p" data-group-id="7569298402-1">]</span><span class="w">
</span><span class="n">prop</span><span class="w"> </span><span class="n">page_info</span><span class="p">,</span><span class="w"> </span><span class="ss">:any</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="w">
</span><span class="n">prop</span><span class="w"> </span><span class="n">loading</span><span class="p">,</span><span class="w"> </span><span class="ss">:boolean</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="w">
</span><span class="n">prop</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span></code></pre><h3 id="6-initial-data-loading-pattern" class="section-heading"><a href="#6-initial-data-loading-pattern" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">6. Initial Data Loading Pattern</span></h3><p>For initial page loads, use load functions that set up all required state:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">load_initial_data</span><span class="p" data-group-id="7040971886-1">(</span><span class="n">filters</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7040971886-1">)</span><span class="w"> </span><span class="k" data-group-id="7040971886-2">do</span><span class="w">
  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">YourContext</span><span class="o">.</span><span class="n">list_items</span><span class="p" data-group-id="7040971886-3">(</span><span class="n">filters</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="7040971886-3">)</span><span class="w">
  
  </span><span class="p" data-group-id="7040971886-4">[</span><span class="w">
    </span><span class="ss">loading</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w">
    </span><span class="ss">items</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="7040971886-5">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ss">:edges</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7040971886-6">[</span><span class="p" data-group-id="7040971886-6">]</span><span class="p" data-group-id="7040971886-5">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">page_info</span><span class="p">:</span><span class="w"> </span><span class="n">e</span><span class="p" data-group-id="7040971886-7">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="ss">:page_info</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7040971886-8">[</span><span class="p" data-group-id="7040971886-8">]</span><span class="p" data-group-id="7040971886-7">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">previous_page_info</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w">
    </span><span class="ss">context</span><span class="p">:</span><span class="w"> </span><span class="n">opts</span><span class="p" data-group-id="7040971886-9">[</span><span class="ss">:context</span><span class="p" data-group-id="7040971886-9">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s">&quot;default&quot;</span><span class="w">
  </span><span class="p" data-group-id="7040971886-4">]</span><span class="w">
</span><span class="k" data-group-id="7040971886-2">end</span></code></pre><h2 id="error-handling-standards" class="section-heading"><a href="#error-handling-standards" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Error Handling Standards</span></h2><h3 id="validation-patterns" class="section-heading"><a href="#validation-patterns" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Validation Patterns:</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># Check required data exists</span><span class="w">
</span><span class="k">if</span><span class="w"> </span><span class="n">is_nil</span><span class="p" data-group-id="7629061783-1">(</span><span class="n">required_data</span><span class="p" data-group-id="7629061783-1">)</span><span class="w"> </span><span class="k" data-group-id="7629061783-2">do</span><span class="w">
  </span><span class="p" data-group-id="7629061783-3">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">assign_flash</span><span class="p" data-group-id="7629061783-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="7629061783-5">(</span><span class="s">&quot;Required data missing&quot;</span><span class="p" data-group-id="7629061783-5">)</span><span class="p" data-group-id="7629061783-4">)</span><span class="p" data-group-id="7629061783-3">}</span></code></pre><h3 id="error-recovery" class="section-heading"><a href="#error-recovery" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Error Recovery:</span></h3><pre><code class="makeup elixir" translate="no"><span class="k">try</span><span class="w"> </span><span class="k" data-group-id="5017304635-1">do</span><span class="w">
  </span><span class="c1"># pagination logic</span><span class="w">
</span><span class="k" data-group-id="5017304635-1">rescue</span><span class="w">
  </span><span class="n">error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="n">error</span><span class="p" data-group-id="5017304635-2">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to load more </span><span class="si" data-group-id="5017304635-3">#{</span><span class="n">context</span><span class="si" data-group-id="5017304635-3">}</span><span class="s">&quot;</span><span class="p" data-group-id="5017304635-2">)</span><span class="w">
    </span><span class="p" data-group-id="5017304635-4">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">assign_flash</span><span class="p" data-group-id="5017304635-5">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p" data-group-id="5017304635-6">(</span><span class="s">&quot;Could not load more&quot;</span><span class="p" data-group-id="5017304635-6">)</span><span class="p" data-group-id="5017304635-5">)</span><span class="p" data-group-id="5017304635-4">}</span><span class="w">
</span><span class="k" data-group-id="5017304635-1">end</span></code></pre><h2 id="testing-patterns" class="section-heading"><a href="#testing-patterns" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Testing Patterns</span></h2><h3 id="test-setup" class="section-heading"><a href="#test-setup" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Setup:</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">test</span><span class="w"> </span><span class="s">&quot;Load more works for component&quot;</span><span class="w"> </span><span class="k" data-group-id="0175986882-1">do</span><span class="w">
  </span><span class="c1"># Set pagination limit for testing</span><span class="w">
  </span><span class="n">original_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Config</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="0175986882-2">(</span><span class="ss">:default_pagination_limit</span><span class="p" data-group-id="0175986882-2">)</span><span class="w">
  </span><span class="nc">Config</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="0175986882-3">(</span><span class="ss">:default_pagination_limit</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="0175986882-3">)</span><span class="w">
  
  </span><span class="n">on_exit</span><span class="p" data-group-id="0175986882-4">(</span><span class="k" data-group-id="0175986882-5">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
    </span><span class="nc">Config</span><span class="o">.</span><span class="n">put</span><span class="p" data-group-id="0175986882-6">(</span><span class="ss">:default_pagination_limit</span><span class="p">,</span><span class="w"> </span><span class="n">original_limit</span><span class="p" data-group-id="0175986882-6">)</span><span class="w">
  </span><span class="k" data-group-id="0175986882-5">end</span><span class="p" data-group-id="0175986882-4">)</span><span class="w">
  
  </span><span class="c1"># Create test data (more than pagination limit)</span><span class="w">
  </span><span class="c1"># Test initial load shows limited results</span><span class="w">
  </span><span class="c1"># Test clicking load more shows additional results</span><span class="w">
</span><span class="k" data-group-id="0175986882-1">end</span></code></pre><h3 id="dom-assertions" class="section-heading"><a href="#dom-assertions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">DOM Assertions:</span></h3><pre><code class="makeup elixir" translate="no"><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conn</span><span class="p" data-group-id="6217584414-1">(</span><span class="ss">user</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="ss">account</span><span class="p">:</span><span class="w"> </span><span class="n">account</span><span class="p" data-group-id="6217584414-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">visit</span><span class="p" data-group-id="6217584414-2">(</span><span class="s">&quot;/your-page&quot;</span><span class="p" data-group-id="6217584414-2">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">assert_has</span><span class="p" data-group-id="6217584414-3">(</span><span class="s">&quot;[data-id=item_identifier]&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">count</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="6217584414-3">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">click_button</span><span class="p" data-group-id="6217584414-4">(</span><span class="s">&quot;[data-id=load_more]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Load more&quot;</span><span class="p" data-group-id="6217584414-4">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">assert_has</span><span class="p" data-group-id="6217584414-5">(</span><span class="s">&quot;[data-id=item_identifier]&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">count</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p" data-group-id="6217584414-5">)</span></code></pre><h2 id="state-management-checklist" class="section-heading"><a href="#state-management-checklist" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">State Management Checklist</span></h2><p>When implementing pagination, ensure you handle:</p><ul><li>[ ] <strong>Initial Loading</strong>: <code class="inline">loading: false</code> after data loads</li><li>[ ] <strong>Data Accumulation</strong>: Append new results with <code class="inline">++</code></li><li>[ ] <strong>Page Info</strong>: Update with new pagination metadata</li><li>[ ] <strong>Previous Page Info</strong>: Track for navigation/debugging</li><li>[ ] <strong>Error States</strong>: Graceful error handling with user feedback</li><li>[ ] <strong>Empty States</strong>: Handle no data scenarios</li><li>[ ] <strong>Context Tracking</strong>: Support multiple lists per page</li><li>[ ] <strong>Validation</strong>: Check required data before processing</li></ul><h2 id="component-integration-patterns" class="section-heading"><a href="#component-integration-patterns" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Component Integration Patterns</span></h2><h3 id="for-stateless-components" class="section-heading"><a href="#for-stateless-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">For Stateless Components:</span></h3><ol><li>Accept <code class="inline">page_info</code> and <code class="inline">items</code> as props</li><li>Include <code class="inline">LoadMoreLive</code> in template</li><li>Let parent LiveView handle events</li></ol><h3 id="for-stateful-components" class="section-heading"><a href="#for-stateful-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">For Stateful Components:</span></h3><ol><li>Implement <code class="inline">handle_event(&quot;load_more&quot;, ...)</code> </li><li>Include <code class="inline">LoadMoreLive</code> in template</li><li>Handle events directly</li></ol><h3 id="for-nested-components" class="section-heading"><a href="#for-nested-components" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">For Nested Components:</span></h3><ol><li>Use <code class="inline">phx-target={@myself}</code> for component-specific events</li><li>Implement event handlers in component module</li><li>Use <code class="inline">context</code> prop to differentiate multiple instances</li></ol><h2 id="performance-considerations" class="section-heading"><a href="#performance-considerations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Performance Considerations</span></h2><h3 id="optimizations" class="section-heading"><a href="#optimizations" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Optimizations:</span></h3><ul><li>Use <code class="inline">deferred_join: true</code> for expensive queries</li><li>Implement proper indexing for pagination queries</li><li>Consider <code class="inline">limit</code> and <code class="inline">multiply_limit</code> for dynamic page sizes</li><li>Use <code class="inline">preload_more</code> for better infinite scroll UX</li></ul><h3 id="anti-patterns-to-avoid" class="section-heading"><a href="#anti-patterns-to-avoid" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Anti-patterns to Avoid:</span></h3><ul><li>Loading all data then paginating in memory</li><li>Not handling error states</li><li>Forgetting to append data (overwriting instead)</li><li>Missing context for multiple lists</li><li>Not validating user permissions for pagination</li></ul><h2 id="debug-helpers" class="section-heading"><a href="#debug-helpers" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Debug Helpers</span></h2><h3 id="common-issues" class="section-heading"><a href="#common-issues" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Common Issues:</span></h3><ol><li><strong>Events not triggering</strong>: Check parent LiveView routing</li><li><strong>Data not appending</strong>: Verify <code class="inline">++</code> operator usage</li><li><strong>Page info missing</strong>: Ensure backend returns proper structure</li><li><strong>Context confusion</strong>: Use unique context values per list</li></ol><h3 id="debug-functions" class="section-heading"><a href="#debug-functions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Debug Functions:</span></h3><pre><code class="makeup elixir" translate="no"><span class="c1"># In handlers, use debug to trace data flow</span><span class="w">
</span><span class="n">pagination</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">debug</span><span class="p" data-group-id="0520437101-1">(</span><span class="s">&quot;pagination_params&quot;</span><span class="p" data-group-id="0520437101-1">)</span><span class="w">
</span><span class="n">new_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">debug</span><span class="p" data-group-id="0520437101-2">(</span><span class="s">&quot;loaded_data&quot;</span><span class="p" data-group-id="0520437101-2">)</span><span class="w">
</span><span class="n">e</span><span class="p" data-group-id="0520437101-3">(</span><span class="n">assigns</span><span class="p" data-group-id="0520437101-4">(</span><span class="n">socket</span><span class="p" data-group-id="0520437101-4">)</span><span class="p">,</span><span class="w"> </span><span class="ss">:items</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0520437101-5">[</span><span class="p" data-group-id="0520437101-5">]</span><span class="p" data-group-id="0520437101-3">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">debug</span><span class="p" data-group-id="0520437101-6">(</span><span class="s">&quot;existing_items&quot;</span><span class="p" data-group-id="0520437101-6">)</span></code></pre><p>This guide should be used as the canonical reference for all pagination implementations in Bonfire. Follow these patterns to ensure consistency, reliability, and maintainability across the codebase.</p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="bonfire-flavoured-elixir.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Bonfire-flavoured Elixir
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="design.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Design Guidelines
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="Bonfire.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.4) for the

          <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
